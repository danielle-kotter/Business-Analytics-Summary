<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter - 6 Basics Python | Business Analytics - Cheatsheets &amp; Summary</title>
  <meta name="description" content="This is a summary of code &amp; theory studied throughout several courses of my MSc in management with a specialization in Business Analytics." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter - 6 Basics Python | Business Analytics - Cheatsheets &amp; Summary" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a summary of code &amp; theory studied throughout several courses of my MSc in management with a specialization in Business Analytics." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter - 6 Basics Python | Business Analytics - Cheatsheets &amp; Summary" />
  
  <meta name="twitter:description" content="This is a summary of code &amp; theory studied throughout several courses of my MSc in management with a specialization in Business Analytics." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structural-equation-models.html"/>
<link rel="next" href="practical-data-science.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cheatsheets & Summary</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="basics-r.html"><a href="basics-r.html"><i class="fa fa-check"></i><b>1</b> Basics R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics-r.html"><a href="basics-r.html#simple-statistics"><i class="fa fa-check"></i><b>1.1</b> Simple statistics</a></li>
<li class="chapter" data-level="1.2" data-path="basics-r.html"><a href="basics-r.html#tables-frames-matrices"><i class="fa fa-check"></i><b>1.2</b> Tables, frames &amp; matrices</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basics-r.html"><a href="basics-r.html#combining-sets-and-setting-names"><i class="fa fa-check"></i><b>1.2.1</b> Combining sets and setting names:</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="basics-r.html"><a href="basics-r.html#data-sets"><i class="fa fa-check"></i><b>1.3</b> Data sets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="basics-r.html"><a href="basics-r.html#subsetting"><i class="fa fa-check"></i><b>1.3.1</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="basics-r.html"><a href="basics-r.html#r-markdown"><i class="fa fa-check"></i><b>1.4</b> R Markdown</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="basics-r.html"><a href="basics-r.html#setup-rmarkdown-code-chunks"><i class="fa fa-check"></i><b>1.4.1</b> Setup rmarkdown &amp; code chunks</a></li>
<li class="chapter" data-level="1.4.2" data-path="basics-r.html"><a href="basics-r.html#latex"><i class="fa fa-check"></i><b>1.4.2</b> Latex</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="basics-r.html"><a href="basics-r.html#miscellaneous"><i class="fa fa-check"></i><b>1.5</b> Miscellaneous</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="basics-r.html"><a href="basics-r.html#removing-infinite-na-values"><i class="fa fa-check"></i><b>1.5.1</b> Removing infinite + NA values</a></li>
<li class="chapter" data-level="1.5.2" data-path="basics-r.html"><a href="basics-r.html#transforming-variable-types"><i class="fa fa-check"></i><b>1.5.2</b> Transforming variable types</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-data-visualization.html"><a href="r-data-visualization.html"><i class="fa fa-check"></i><b>2</b> R Data visualization</a></li>
<li class="chapter" data-level="3" data-path="applied-statistics.html"><a href="applied-statistics.html"><i class="fa fa-check"></i><b>3</b> Applied Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="applied-statistics.html"><a href="applied-statistics.html#probability"><i class="fa fa-check"></i><b>3.1</b> Probability</a></li>
<li class="chapter" data-level="3.2" data-path="applied-statistics.html"><a href="applied-statistics.html#bayes-theorem"><i class="fa fa-check"></i><b>3.2</b> Bayes theorem</a></li>
<li class="chapter" data-level="3.3" data-path="applied-statistics.html"><a href="applied-statistics.html#discrete-probablity"><i class="fa fa-check"></i><b>3.3</b> Discrete probablity</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="applied-statistics.html"><a href="applied-statistics.html#uniform-discrete-probability-distribution"><i class="fa fa-check"></i><b>3.3.1</b> Uniform discrete probability distribution</a></li>
<li class="chapter" data-level="3.3.2" data-path="applied-statistics.html"><a href="applied-statistics.html#binomial-distribution"><i class="fa fa-check"></i><b>3.3.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="3.3.3" data-path="applied-statistics.html"><a href="applied-statistics.html#poisson-distribution"><i class="fa fa-check"></i><b>3.3.3</b> Poisson distribution</a></li>
<li class="chapter" data-level="3.3.4" data-path="applied-statistics.html"><a href="applied-statistics.html#the-normal-distribution"><i class="fa fa-check"></i><b>3.3.4</b> The normal distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="applied-statistics.html"><a href="applied-statistics.html#samples-estimation-confidence-intervals"><i class="fa fa-check"></i><b>3.4</b> Samples, estimation &amp; confidence intervals</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="applied-statistics.html"><a href="applied-statistics.html#sample-size"><i class="fa fa-check"></i><b>3.4.1</b> Sample size</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="applied-statistics.html"><a href="applied-statistics.html#significance-level"><i class="fa fa-check"></i><b>3.5</b> Significance level</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="applied-statistics.html"><a href="applied-statistics.html#critical-values"><i class="fa fa-check"></i><b>3.5.1</b> Critical values</a></li>
<li class="chapter" data-level="3.5.2" data-path="applied-statistics.html"><a href="applied-statistics.html#test-of-equality---two-samples"><i class="fa fa-check"></i><b>3.5.2</b> Test of equality - two samples</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="applied-statistics.html"><a href="applied-statistics.html#non-parametric-testing"><i class="fa fa-check"></i><b>3.6</b> Non-Parametric testing</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="applied-statistics.html"><a href="applied-statistics.html#contingency-table-frequencies"><i class="fa fa-check"></i><b>3.6.1</b> Contingency table / frequencies</a></li>
<li class="chapter" data-level="3.6.2" data-path="applied-statistics.html"><a href="applied-statistics.html#chi-square"><i class="fa fa-check"></i><b>3.6.2</b> Chi-square</a></li>
<li class="chapter" data-level="3.6.3" data-path="applied-statistics.html"><a href="applied-statistics.html#goodness-of-fit"><i class="fa fa-check"></i><b>3.6.3</b> Goodness of fit</a></li>
<li class="chapter" data-level="3.6.4" data-path="applied-statistics.html"><a href="applied-statistics.html#mann-whitney-test"><i class="fa fa-check"></i><b>3.6.4</b> Mann-whitney test</a></li>
<li class="chapter" data-level="3.6.5" data-path="applied-statistics.html"><a href="applied-statistics.html#wilcoxon-test"><i class="fa fa-check"></i><b>3.6.5</b> Wilcoxon test</a></li>
<li class="chapter" data-level="3.6.6" data-path="applied-statistics.html"><a href="applied-statistics.html#run-test"><i class="fa fa-check"></i><b>3.6.6</b> Run test</a></li>
<li class="chapter" data-level="3.6.7" data-path="applied-statistics.html"><a href="applied-statistics.html#p-value"><i class="fa fa-check"></i><b>3.6.7</b> P-value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-regressions.html"><a href="simple-regressions.html"><i class="fa fa-check"></i><b>4</b> Simple regressions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-regressions.html"><a href="simple-regressions.html#basics-regressions"><i class="fa fa-check"></i><b>4.1</b> Basics regressions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="simple-regressions.html"><a href="simple-regressions.html#summarizing-regressions"><i class="fa fa-check"></i><b>4.1.1</b> Summarizing regressions:</a></li>
<li class="chapter" data-level="4.1.2" data-path="simple-regressions.html"><a href="simple-regressions.html#visualizing-model"><i class="fa fa-check"></i><b>4.1.2</b> Visualizing model</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-regressions.html"><a href="simple-regressions.html#prediction"><i class="fa fa-check"></i><b>4.2</b> Prediction</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simple-regressions.html"><a href="simple-regressions.html#confidence-and-prediction-plotting"><i class="fa fa-check"></i><b>4.2.1</b> Confidence and prediction plotting</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-regressions.html"><a href="simple-regressions.html#prediction-with-dummy-variables"><i class="fa fa-check"></i><b>4.2.2</b> Prediction with dummy variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="simple-regressions.html"><a href="simple-regressions.html#prediction-intervals-examples"><i class="fa fa-check"></i><b>4.2.3</b> Prediction intervals examples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-regressions.html"><a href="simple-regressions.html#data-problems"><i class="fa fa-check"></i><b>4.3</b> Data problems</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simple-regressions.html"><a href="simple-regressions.html#multicollinearity"><i class="fa fa-check"></i><b>4.3.1</b> Multicollinearity</a></li>
<li class="chapter" data-level="4.3.2" data-path="simple-regressions.html"><a href="simple-regressions.html#variance-inflation-factors"><i class="fa fa-check"></i><b>4.3.2</b> Variance inflation factors</a></li>
<li class="chapter" data-level="4.3.3" data-path="simple-regressions.html"><a href="simple-regressions.html#anova"><i class="fa fa-check"></i><b>4.3.3</b> ANOVA</a></li>
<li class="chapter" data-level="4.3.4" data-path="simple-regressions.html"><a href="simple-regressions.html#linearizing-variables"><i class="fa fa-check"></i><b>4.3.4</b> Linearizing variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="structural-equation-models.html"><a href="structural-equation-models.html"><i class="fa fa-check"></i><b>5</b> Structural equation models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#path-analysis-structural-equations"><i class="fa fa-check"></i><b>5.1</b> Path analysis (structural equations)</a></li>
<li class="chapter" data-level="5.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#coding-the-model"><i class="fa fa-check"></i><b>5.2</b> Coding the model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#covariance"><i class="fa fa-check"></i><b>5.2.1</b> Covariance</a></li>
<li class="chapter" data-level="5.2.2" data-path="structural-equation-models.html"><a href="structural-equation-models.html#reliability"><i class="fa fa-check"></i><b>5.2.2</b> Reliability</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="structural-equation-models.html"><a href="structural-equation-models.html#factor-model"><i class="fa fa-check"></i><b>5.3</b> Factor model</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="structural-equation-models.html"><a href="structural-equation-models.html#setting-covariance-variances"><i class="fa fa-check"></i><b>5.3.1</b> Setting covariance &amp; variances</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basics-python.html"><a href="basics-python.html"><i class="fa fa-check"></i><b>6</b> Basics Python</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basics-python.html"><a href="basics-python.html#data-set"><i class="fa fa-check"></i><b>6.1</b> Data set</a></li>
<li class="chapter" data-level="6.2" data-path="basics-python.html"><a href="basics-python.html#matrixes"><i class="fa fa-check"></i><b>6.2</b> Matrixes</a></li>
<li class="chapter" data-level="6.3" data-path="basics-python.html"><a href="basics-python.html#filtering-a-data-set"><i class="fa fa-check"></i><b>6.3</b> Filtering a data set</a></li>
<li class="chapter" data-level="6.4" data-path="basics-python.html"><a href="basics-python.html#data-imputation"><i class="fa fa-check"></i><b>6.4</b> Data imputation</a></li>
<li class="chapter" data-level="6.5" data-path="basics-python.html"><a href="basics-python.html#data-visualization"><i class="fa fa-check"></i><b>6.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="basics-python.html"><a href="basics-python.html#other-categorical-plots"><i class="fa fa-check"></i><b>6.5.1</b> Other categorical plots</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="basics-python.html"><a href="basics-python.html#preparing-data-for-modeling"><i class="fa fa-check"></i><b>6.6</b> Preparing data for modeling</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="basics-python.html"><a href="basics-python.html#creating-the-models"><i class="fa fa-check"></i><b>6.6.1</b> Creating the models</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="basics-python.html"><a href="basics-python.html#model-selection"><i class="fa fa-check"></i><b>6.7</b> Model selection</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="basics-python.html"><a href="basics-python.html#leave-one-out-cross-validation-loocv"><i class="fa fa-check"></i><b>6.7.1</b> <strong>Leave-One-Out Cross validation (LOOCV):</strong></a></li>
<li class="chapter" data-level="6.7.2" data-path="basics-python.html"><a href="basics-python.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>6.7.2</b> <strong>K-Fold Cross validation</strong></a></li>
<li class="chapter" data-level="6.7.3" data-path="basics-python.html"><a href="basics-python.html#svc"><i class="fa fa-check"></i><b>6.7.3</b> SVC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="practical-data-science.html"><a href="practical-data-science.html"><i class="fa fa-check"></i><b>7</b> Practical Data Science</a>
<ul>
<li class="chapter" data-level="7.1" data-path="practical-data-science.html"><a href="practical-data-science.html#machine-learning"><i class="fa fa-check"></i><b>7.1</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="practical-data-science.html"><a href="practical-data-science.html#theory"><i class="fa fa-check"></i><b>7.1.1</b> Theory</a></li>
<li class="chapter" data-level="7.1.2" data-path="practical-data-science.html"><a href="practical-data-science.html#data-set-1"><i class="fa fa-check"></i><b>7.1.2</b> Data set</a></li>
<li class="chapter" data-level="7.1.3" data-path="practical-data-science.html"><a href="practical-data-science.html#finding-the-expected-value-of-the-error"><i class="fa fa-check"></i><b>7.1.3</b> Finding the expected value of the error</a></li>
<li class="chapter" data-level="7.1.4" data-path="practical-data-science.html"><a href="practical-data-science.html#finding-the-error"><i class="fa fa-check"></i><b>7.1.4</b> Finding the error</a></li>
<li class="chapter" data-level="7.1.5" data-path="practical-data-science.html"><a href="practical-data-science.html#loss-function"><i class="fa fa-check"></i><b>7.1.5</b> Loss function</a></li>
<li class="chapter" data-level="7.1.6" data-path="practical-data-science.html"><a href="practical-data-science.html#training-vs-test-set"><i class="fa fa-check"></i><b>7.1.6</b> Training vs test set</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="practical-data-science.html"><a href="practical-data-science.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>7.2</b> Bias-variance trade off</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="practical-data-science.html"><a href="practical-data-science.html#training-fitting-a-model"><i class="fa fa-check"></i><b>7.2.1</b> Training (fitting) a model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="practical-data-science.html"><a href="practical-data-science.html#gradient-descent"><i class="fa fa-check"></i><b>7.3</b> Gradient descent</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="practical-data-science.html"><a href="practical-data-science.html#stochastic-gradient-descent"><i class="fa fa-check"></i><b>7.3.1</b> Stochastic gradient descent</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="practical-data-science.html"><a href="practical-data-science.html#model-selection-1"><i class="fa fa-check"></i><b>7.4</b> Model Selection</a></li>
<li class="chapter" data-level="7.5" data-path="practical-data-science.html"><a href="practical-data-science.html#validations-methods"><i class="fa fa-check"></i><b>7.5</b> Validations methods</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="practical-data-science.html"><a href="practical-data-science.html#hold-out-validation-method"><i class="fa fa-check"></i><b>7.5.1</b> Hold-Out validation method</a></li>
<li class="chapter" data-level="7.5.2" data-path="practical-data-science.html"><a href="practical-data-science.html#standardization"><i class="fa fa-check"></i><b>7.5.2</b> Standardization</a></li>
<li class="chapter" data-level="7.5.3" data-path="practical-data-science.html"><a href="practical-data-science.html#leave-one-out-cross-validation-method-loocv"><i class="fa fa-check"></i><b>7.5.3</b> Leave-One-Out Cross-validation method (LOOCV):</a></li>
<li class="chapter" data-level="7.5.4" data-path="practical-data-science.html"><a href="practical-data-science.html#k-fold-cross-validation-1"><i class="fa fa-check"></i><b>7.5.4</b> K-Fold Cross Validation</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="practical-data-science.html"><a href="practical-data-science.html#classification-problems"><i class="fa fa-check"></i><b>7.6</b> Classification Problems</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="practical-data-science.html"><a href="practical-data-science.html#evaluating-model-quality"><i class="fa fa-check"></i><b>7.6.1</b> Evaluating model quality</a></li>
<li class="chapter" data-level="7.6.2" data-path="practical-data-science.html"><a href="practical-data-science.html#receiver-operating-characteristics-roc"><i class="fa fa-check"></i><b>7.6.2</b> Receiver Operating Characteristics (ROC)</a></li>
<li class="chapter" data-level="7.6.3" data-path="practical-data-science.html"><a href="practical-data-science.html#multi-class-classification"><i class="fa fa-check"></i><b>7.6.3</b> Multi-class classification</a></li>
<li class="chapter" data-level="7.6.4" data-path="practical-data-science.html"><a href="practical-data-science.html#maximal-margin-classifier"><i class="fa fa-check"></i><b>7.6.4</b> Maximal Margin Classifier</a></li>
<li class="chapter" data-level="7.6.5" data-path="practical-data-science.html"><a href="practical-data-science.html#support-vector-classifier"><i class="fa fa-check"></i><b>7.6.5</b> Support vector classifier</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html"><i class="fa fa-check"></i><b>8</b> Advanced Statistical Methods</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#clustering"><i class="fa fa-check"></i><b>8.1</b> Clustering</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#hierarchical-clustering"><i class="fa fa-check"></i><b>8.1.1</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="8.1.2" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#dendrogram"><i class="fa fa-check"></i><b>8.1.2</b> Dendrogram</a></li>
<li class="chapter" data-level="8.1.3" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#non-hierarchical-clustering"><i class="fa fa-check"></i><b>8.1.3</b> Non-Hierarchical clustering</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#multi-dimensional-scaling"><i class="fa fa-check"></i><b>8.2</b> Multi-Dimensional Scaling</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#principal-component-analysis"><i class="fa fa-check"></i><b>8.3</b> Principal component analysis</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#biplots"><i class="fa fa-check"></i><b>8.3.1</b> Biplots</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#correspondence-analysis"><i class="fa fa-check"></i><b>8.4</b> Correspondence analysis</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#multiple-correspondence-analysis"><i class="fa fa-check"></i><b>8.4.1</b> Multiple Correspondence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="advanced-statistical-methods.html"><a href="advanced-statistical-methods.html#multiple-linear-regression-classification-trees"><i class="fa fa-check"></i><b>8.5</b> Multiple linear regression &amp; classification trees</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="marketing-analytics.html"><a href="marketing-analytics.html"><i class="fa fa-check"></i><b>9</b> Marketing Analytics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="marketing-analytics.html"><a href="marketing-analytics.html#logistic-regression"><i class="fa fa-check"></i><b>9.1</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="marketing-analytics.html"><a href="marketing-analytics.html#sensitivity-vs-specificity"><i class="fa fa-check"></i><b>9.1.1</b> Sensitivity vs Specificity</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="marketing-analytics.html"><a href="marketing-analytics.html#conjoint-analytics"><i class="fa fa-check"></i><b>9.2</b> Conjoint Analytics</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="marketing-analytics.html"><a href="marketing-analytics.html#random-utility-model"><i class="fa fa-check"></i><b>9.2.1</b> Random utility model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Business Analytics - Cheatsheets &amp; Summary</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basics-python" class="section level1" number="6">
<h1><span class="header-section-number">Chapter - 6</span> Basics Python</h1>
<p><em>Class given by: Alberto Santini</em></p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r watch-out"><code class="sourceCode r"><span id="cb224-1"><a href="basics-python.html#cb224-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb224-2"><a href="basics-python.html#cb224-2" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>[1] 10</code></pre>
<p>Printing characters</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r watch-out"><code class="sourceCode r"><span id="cb226-1"><a href="basics-python.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Hello, readers!&#39;</span>)</span></code></pre></div>
<pre><code>[1] &quot;Hello, readers!&quot;</code></pre>
<p>Printing numbers</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r watch-out"><code class="sourceCode r"><span id="cb228-1"><a href="basics-python.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>[1] 15</code></pre>
<p>Printing length of a value</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb230-1"><a href="basics-python.html#cb230-1" aria-hidden="true" tabindex="-1"></a>Length <span class="op">=</span> <span class="bu">len</span>(<span class="st">&#39;Danielle&#39;</span>)</span>
<span id="cb230-2"><a href="basics-python.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Length)</span></code></pre></div>
<pre><code>8</code></pre>
<p><strong>Creating own functions:</strong></p>
<p>Saying hello + name</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb232-1"><a href="basics-python.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> printing_name(name):</span>
<span id="cb232-2"><a href="basics-python.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&#39;Good morning,&#39;</span>, name)</span>
<span id="cb232-3"><a href="basics-python.html#cb232-3" aria-hidden="true" tabindex="-1"></a>printing_name(<span class="st">&#39;Danielle&#39;</span>)</span></code></pre></div>
<pre><code>Good morning, Danielle</code></pre>
<p>Multiple arguments:</p>
<p>Saying hello + name + location</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb234-1"><a href="basics-python.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> welcome(name, location):</span>
<span id="cb234-2"><a href="basics-python.html#cb234-2" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">&quot;Good morning&quot;</span>, name, <span class="st">&quot;Welcome to&quot;</span>, location)</span>
<span id="cb234-3"><a href="basics-python.html#cb234-3" aria-hidden="true" tabindex="-1"></a>welcome(<span class="st">&quot;Danielle,&quot;</span>, <span class="st">&quot;class.&quot;</span>)</span></code></pre></div>
<pre><code>Good morning Danielle, Welcome to class.</code></pre>
<hr />
<div id="data-set" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Data set</h2>
<p>Loading the data set &amp; viewing head + tails:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb236-1"><a href="basics-python.html#cb236-1" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">&#39;paper&#39;</span>)</span>
<span id="cb236-2"><a href="basics-python.html#cb236-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-3"><a href="basics-python.html#cb236-3" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&#39;tips&#39;</span>)</span>
<span id="cb236-4"><a href="basics-python.html#cb236-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb236-5"><a href="basics-python.html#cb236-5" aria-hidden="true" tabindex="-1"></a>tips.head()</span></code></pre></div>
<pre><code>   total_bill   tip     sex smoker  day    time  size
0       16.99  1.01  Female     No  Sun  Dinner     2
1       10.34  1.66    Male     No  Sun  Dinner     3
2       21.01  3.50    Male     No  Sun  Dinner     3
3       23.68  3.31    Male     No  Sun  Dinner     2
4       24.59  3.61  Female     No  Sun  Dinner     4</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb238-1"><a href="basics-python.html#cb238-1" aria-hidden="true" tabindex="-1"></a>tips.tail()</span></code></pre></div>
<pre><code>     total_bill   tip     sex smoker   day    time  size
239       29.03  5.92    Male     No   Sat  Dinner     3
240       27.18  2.00  Female    Yes   Sat  Dinner     2
241       22.67  2.00    Male    Yes   Sat  Dinner     2
242       17.82  1.75    Male     No   Sat  Dinner     2
243       18.78  3.00  Female     No  Thur  Dinner     2</code></pre>
<p><strong>Basic stats</strong></p>
<ol style="list-style-type: decimal">
<li>Length of the variable</li>
<li>Shape: Number of rows and number of columns</li>
<li>Type of variables + basic info</li>
<li>Descriptive statistics variable</li>
</ol>
<div class="sourceCode" id="cb240"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb240-1"><a href="basics-python.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(tips)</span></code></pre></div>
<pre><code>244</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb242-1"><a href="basics-python.html#cb242-1" aria-hidden="true" tabindex="-1"></a>tips.shape</span></code></pre></div>
<pre><code>(244, 7)</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb244-1"><a href="basics-python.html#cb244-1" aria-hidden="true" tabindex="-1"></a>tips.info()</span></code></pre></div>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 244 entries, 0 to 243
Data columns (total 7 columns):
 #   Column      Non-Null Count  Dtype   
---  ------      --------------  -----   
 0   total_bill  244 non-null    float64 
 1   tip         244 non-null    float64 
 2   sex         244 non-null    category
 3   smoker      244 non-null    category
 4   day         244 non-null    category
 5   time        244 non-null    category
 6   size        244 non-null    int64   
dtypes: category(4), float64(2), int64(1)
memory usage: 7.3 KB</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb246-1"><a href="basics-python.html#cb246-1" aria-hidden="true" tabindex="-1"></a>tips.describe()</span></code></pre></div>
<pre><code>       total_bill         tip        size
count  244.000000  244.000000  244.000000
mean    19.785943    2.998279    2.569672
std      8.902412    1.383638    0.951100
min      3.070000    1.000000    1.000000
25%     13.347500    2.000000    2.000000
50%     17.795000    2.900000    2.000000
75%     24.127500    3.562500    3.000000
max     50.810000   10.000000    6.000000</code></pre>
<p><strong>Reading from a csv file with pandas:</strong></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb248-1"><a href="basics-python.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb248-2"><a href="basics-python.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="basics-python.html#cb248-3" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pd.read_csv(<span class="st">&#39;www/auto-mpg.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb249"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb249-1"><a href="basics-python.html#cb249-1" aria-hidden="true" tabindex="-1"></a>d.mpg.mean().<span class="bu">round</span>() <span class="co"># rounding by amount of decimals</span></span></code></pre></div>
<pre><code>23.0</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb251-1"><a href="basics-python.html#cb251-1" aria-hidden="true" tabindex="-1"></a>d.dtypes <span class="co"># describes the type of variables</span></span></code></pre></div>
<pre><code>mpg             float64
cylinders         int64
displacement    float64
hp              float64
weight          float64
acceleration    float64
year              int64
origin            int64
dtype: object</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb253-1"><a href="basics-python.html#cb253-1" aria-hidden="true" tabindex="-1"></a>pd.to_numeric(d.hp) <span class="co"># transforms to numerical</span></span></code></pre></div>
<pre><code>0      130.0
1      165.0
2      150.0
3      150.0
4      140.0
       ...  
387     86.0
388     52.0
389     84.0
390     79.0
391     82.0
Name: hp, Length: 392, dtype: float64</code></pre>
<p><strong>Descriptive statistics:</strong></p>
<div class="sourceCode" id="cb255"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb255-1"><a href="basics-python.html#cb255-1" aria-hidden="true" tabindex="-1"></a>d.mpg.mean()</span></code></pre></div>
<pre><code>23.445918367346938</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb257-1"><a href="basics-python.html#cb257-1" aria-hidden="true" tabindex="-1"></a>d.mpg.median()</span></code></pre></div>
<pre><code>22.75</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb259-1"><a href="basics-python.html#cb259-1" aria-hidden="true" tabindex="-1"></a>d.mpg.<span class="bu">max</span>()</span></code></pre></div>
<pre><code>46.6</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb261-1"><a href="basics-python.html#cb261-1" aria-hidden="true" tabindex="-1"></a>d.mpg.<span class="bu">min</span>()</span></code></pre></div>
<pre><code>9.0</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb263-1"><a href="basics-python.html#cb263-1" aria-hidden="true" tabindex="-1"></a>d.mean() <span class="co"># mean for all columns</span></span></code></pre></div>
<pre><code>mpg               23.445918
cylinders          5.471939
displacement     194.411990
hp               104.469388
weight          2977.584184
acceleration      15.541327
year              75.979592
origin             1.576531
dtype: float64</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb265-1"><a href="basics-python.html#cb265-1" aria-hidden="true" tabindex="-1"></a>d.describe().<span class="bu">round</span>(<span class="dv">2</span>).head() <span class="co"># statistics for the whole data set, rounded to two decimals</span></span></code></pre></div>
<pre><code>          mpg  cylinders  displacement  ...  acceleration    year  origin
count  392.00     392.00        392.00  ...        392.00  392.00  392.00
mean    23.45       5.47        194.41  ...         15.54   75.98    1.58
std      7.81       1.71        104.64  ...          2.76    3.68    0.81
min      9.00       3.00         68.00  ...          8.00   70.00    1.00
25%     17.00       4.00        105.00  ...         13.78   73.00    1.00

[5 rows x 8 columns]</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb267-1"><a href="basics-python.html#cb267-1" aria-hidden="true" tabindex="-1"></a>d[[<span class="st">&#39;year&#39;</span>]] <span class="co"># defines a list of one variable</span></span></code></pre></div>
<pre><code>     year
0      70
1      70
2      70
3      70
4      70
..    ...
387    82
388    82
389    82
390    82
391    82

[392 rows x 1 columns]</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb269-1"><a href="basics-python.html#cb269-1" aria-hidden="true" tabindex="-1"></a>d[[<span class="st">&#39;year&#39;</span>, <span class="st">&#39;cylinders&#39;</span>]] <span class="co"># defines a list of multiple variables</span></span></code></pre></div>
<pre><code>     year  cylinders
0      70          8
1      70          8
2      70          8
3      70          8
4      70          8
..    ...        ...
387    82          4
388    82          4
389    82          4
390    82          4
391    82          4

[392 rows x 2 columns]</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb271-1"><a href="basics-python.html#cb271-1" aria-hidden="true" tabindex="-1"></a>d.year.unique() <span class="co"># gives me the unique values of that column, not the repetitions</span></span></code></pre></div>
<pre><code>array([70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82])</code></pre>
<hr />
</div>
<div id="matrixes" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Matrixes</h2>
<p>Series:</p>
<p>Panda series method:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb273-1"><a href="basics-python.html#cb273-1" aria-hidden="true" tabindex="-1"></a>Serie1 <span class="op">=</span> pd.Series(</span>
<span id="cb273-2"><a href="basics-python.html#cb273-2" aria-hidden="true" tabindex="-1"></a>  [<span class="dv">4200</span>, <span class="dv">8000</span>, <span class="dv">6500</span>],</span>
<span id="cb273-3"><a href="basics-python.html#cb273-3" aria-hidden="true" tabindex="-1"></a>  index<span class="op">=</span>[<span class="st">&quot;Amsterdam&quot;</span>, <span class="st">&quot;Toronto&quot;</span>, <span class="st">&quot;Tokyo&quot;</span>]</span>
<span id="cb273-4"><a href="basics-python.html#cb273-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb273-5"><a href="basics-python.html#cb273-5" aria-hidden="true" tabindex="-1"></a>Serie1</span></code></pre></div>
<pre><code>Amsterdam    4200
Toronto      8000
Tokyo        6500
dtype: int64</code></pre>
<p>Python dictionary method:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb275-1"><a href="basics-python.html#cb275-1" aria-hidden="true" tabindex="-1"></a>Serie2 <span class="op">=</span> pd.Series({<span class="st">&quot;Amsterdam&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;Tokyo&quot;</span>: <span class="dv">8</span>})</span>
<span id="cb275-2"><a href="basics-python.html#cb275-2" aria-hidden="true" tabindex="-1"></a>Serie2</span></code></pre></div>
<pre><code>Amsterdam    5
Tokyo        8
dtype: int64</code></pre>
<p>Data frame method + combining sets:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb277-1"><a href="basics-python.html#cb277-1" aria-hidden="true" tabindex="-1"></a>Combined_serie <span class="op">=</span> pd.DataFrame({</span>
<span id="cb277-2"><a href="basics-python.html#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Revenue&quot;</span>: Serie1,</span>
<span id="cb277-3"><a href="basics-python.html#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Employee_count&quot;</span>: Serie2</span>
<span id="cb277-4"><a href="basics-python.html#cb277-4" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb277-5"><a href="basics-python.html#cb277-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb277-6"><a href="basics-python.html#cb277-6" aria-hidden="true" tabindex="-1"></a>Combined_serie</span></code></pre></div>
<pre><code>           Revenue  Employee_count
Amsterdam     4200             5.0
Tokyo         6500             8.0
Toronto       8000             NaN</code></pre>
<p>Sub-setting by row:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb279-1"><a href="basics-python.html#cb279-1" aria-hidden="true" tabindex="-1"></a>Combined_serie[<span class="st">&quot;Tokyo&quot;</span>:]</span></code></pre></div>
<pre><code>         Revenue  Employee_count
Tokyo       6500             8.0
Toronto     8000             NaN</code></pre>
<hr />
</div>
<div id="filtering-a-data-set" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Filtering a data set</h2>
<div class="sourceCode" id="cb281"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb281-1"><a href="basics-python.html#cb281-1" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[d.year <span class="op">==</span> <span class="dv">77</span>] <span class="co">#filters the data set to all observations that are equal to a certain value of a variable </span></span>
<span id="cb281-2"><a href="basics-python.html#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="basics-python.html#cb281-3" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[d.year <span class="op">!=</span> <span class="dv">77</span>] <span class="co">#filters the data set to all observations that are NOT equal to a certain value of a variable </span></span>
<span id="cb281-4"><a href="basics-python.html#cb281-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-5"><a href="basics-python.html#cb281-5" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[d.year <span class="op">&lt;=</span> <span class="dv">77</span>] <span class="co"># filters those that are smaller than a value</span></span>
<span id="cb281-6"><a href="basics-python.html#cb281-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-7"><a href="basics-python.html#cb281-7" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[d.year <span class="op">&gt;=</span> <span class="dv">77</span>] <span class="co"># filters those that are large than a value</span></span>
<span id="cb281-8"><a href="basics-python.html#cb281-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-9"><a href="basics-python.html#cb281-9" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[(d.year <span class="op">&gt;=</span> <span class="dv">77</span>) <span class="op">&amp;</span> (d.year <span class="op">&lt;=</span> <span class="dv">90</span>)] <span class="co"># in between certain values</span></span>
<span id="cb281-10"><a href="basics-python.html#cb281-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-11"><a href="basics-python.html#cb281-11" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[(d.year <span class="op">==</span> <span class="dv">80</span>) <span class="op">|</span> (d.year <span class="op">==</span> <span class="dv">90</span>)] <span class="co"># those from one value OR another</span></span>
<span id="cb281-12"><a href="basics-python.html#cb281-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-13"><a href="basics-python.html#cb281-13" aria-hidden="true" tabindex="-1"></a>d77 <span class="op">=</span> d[<span class="op">~</span>(d.year <span class="op">==</span> <span class="dv">70</span>)] <span class="co"># excludes the values</span></span></code></pre></div>
<p><strong>Aggregating</strong></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb282-1"><a href="basics-python.html#cb282-1" aria-hidden="true" tabindex="-1"></a>dm <span class="op">=</span> d.groupby(<span class="st">&#39;year&#39;</span>).mean()</span>
<span id="cb282-2"><a href="basics-python.html#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="basics-python.html#cb282-3" aria-hidden="true" tabindex="-1"></a>dm <span class="op">=</span> d.groupby([<span class="st">&#39;year&#39;</span>, <span class="st">&#39;cylinders&#39;</span>]).mean()</span>
<span id="cb282-4"><a href="basics-python.html#cb282-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-5"><a href="basics-python.html#cb282-5" aria-hidden="true" tabindex="-1"></a>dm <span class="op">=</span> d.groupby([<span class="st">&#39;year&#39;</span>, <span class="st">&#39;cylinders&#39;</span>]).median()</span>
<span id="cb282-6"><a href="basics-python.html#cb282-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-7"><a href="basics-python.html#cb282-7" aria-hidden="true" tabindex="-1"></a>dm <span class="op">=</span> d.groupby([<span class="st">&#39;year&#39;</span>, <span class="st">&#39;cylinders&#39;</span>]).mean()[<span class="st">&#39;mpg&#39;</span>] <span class="co"># for selected variables only</span></span></code></pre></div>
<p><strong>Pivot table</strong></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb283-1"><a href="basics-python.html#cb283-1" aria-hidden="true" tabindex="-1"></a>d.pivot_table(index<span class="op">=</span><span class="st">&#39;year&#39;</span>, columns<span class="op">=</span><span class="st">&#39;cylinders&#39;</span>, values<span class="op">=</span><span class="st">&#39;mpg&#39;</span>).<span class="bu">round</span>()</span></code></pre></div>
<pre><code>cylinders     3     4     5     6     8
year                                   
70          NaN  25.0   NaN  20.0  14.0
71          NaN  28.0   NaN  18.0  13.0
72         19.0  23.0   NaN   NaN  14.0
73         18.0  23.0   NaN  19.0  13.0
74          NaN  28.0   NaN  17.0  14.0
75          NaN  25.0   NaN  18.0  16.0
76          NaN  27.0   NaN  20.0  15.0
77         22.0  29.0   NaN  20.0  16.0
78          NaN  30.0  20.0  19.0  19.0
79          NaN  32.0  25.0  23.0  19.0
80         24.0  35.0  36.0  26.0   NaN
81          NaN  33.0   NaN  23.0  27.0
82          NaN  32.0   NaN  28.0   NaN</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb285-1"><a href="basics-python.html#cb285-1" aria-hidden="true" tabindex="-1"></a>d.pivot_table(index<span class="op">=</span><span class="st">&#39;year&#39;</span>, columns<span class="op">=</span><span class="st">&#39;cylinders&#39;</span>, values<span class="op">=</span><span class="st">&#39;mpg&#39;</span>).<span class="bu">round</span>().fillna(<span class="st">&#39;&#39;</span>)</span></code></pre></div>
<pre><code>cylinders   3     4   5   6   8
year                           
70             25.0      20  14
71             28.0      18  13
72         19  23.0          14
73         18  23.0      19  13
74             28.0      17  14
75             25.0      18  16
76             27.0      20  15
77         22  29.0      20  16
78             30.0  20  19  19
79             32.0  25  23  19
80         24  35.0  36  26    
81             33.0      23  27
82             32.0      28    </code></pre>
<p><strong>Creating new columns starting from existing columns</strong></p>
<div class="sourceCode" id="cb287"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb287-1"><a href="basics-python.html#cb287-1" aria-hidden="true" tabindex="-1"></a>d[<span class="st">&#39;nam_of_new_column&#39;</span>] <span class="op">=</span> d.mpg <span class="op">*</span> <span class="dv">2</span></span></code></pre></div>
<p>Through the package numpy:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb288-1"><a href="basics-python.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb288-2"><a href="basics-python.html#cb288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-3"><a href="basics-python.html#cb288-3" aria-hidden="true" tabindex="-1"></a>d[<span class="st">&#39;sqrt_of_mpg_2&#39;</span>] <span class="op">=</span> np.sqrt(d.mpg)</span>
<span id="cb288-4"><a href="basics-python.html#cb288-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-5"><a href="basics-python.html#cb288-5" aria-hidden="true" tabindex="-1"></a>d[<span class="st">&#39;log(10)_of_mpg&#39;</span>] <span class="op">=</span> np.log10(d.mpg)</span></code></pre></div>
<p><strong>Dropping / deleting columns</strong></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb289-1"><a href="basics-python.html#cb289-1" aria-hidden="true" tabindex="-1"></a>d[<span class="st">&#39;double_mpg&#39;</span>] <span class="op">=</span> d.mpg <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb289-2"><a href="basics-python.html#cb289-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-3"><a href="basics-python.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span>(d[<span class="st">&#39;double_mpg&#39;</span>]) <span class="co"># deleting columns</span></span>
<span id="cb289-4"><a href="basics-python.html#cb289-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-5"><a href="basics-python.html#cb289-5" aria-hidden="true" tabindex="-1"></a>d.drop(columns<span class="op">=</span>[<span class="st">&#39;sqrt_of_mpg_2&#39;</span>, <span class="st">&#39;log(10)_of_mpg&#39;</span>, <span class="st">&#39;nam_of_new_column&#39;</span>]).head() <span class="co"># dropping columns</span></span></code></pre></div>
<pre><code>    mpg  cylinders  displacement     hp  weight  acceleration  year  origin
0  18.0          8         307.0  130.0  3504.0          12.0    70       1
1  15.0          8         350.0  165.0  3693.0          11.5    70       1
2  18.0          8         318.0  150.0  3436.0          11.0    70       1
3  16.0          8         304.0  150.0  3433.0          12.0    70       1
4  17.0          8         302.0  140.0  3449.0          10.5    70       1</code></pre>
<hr />
</div>
<div id="data-imputation" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Data imputation</h2>
<div class="sourceCode" id="cb291"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb291-1"><a href="basics-python.html#cb291-1" aria-hidden="true" tabindex="-1"></a>pd.to_numeric(d.hp, errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).head()</span></code></pre></div>
<pre><code>0    130.0
1    165.0
2    150.0
3    150.0
4    140.0
Name: hp, dtype: float64</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb293-1"><a href="basics-python.html#cb293-1" aria-hidden="true" tabindex="-1"></a>d.hp <span class="op">=</span> pd.to_numeric(d.hp, errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb293-2"><a href="basics-python.html#cb293-2" aria-hidden="true" tabindex="-1"></a>d[d.hp.isna()] <span class="co"># transform values to NA</span></span></code></pre></div>
<pre><code>Empty DataFrame
Columns: [mpg, cylinders, displacement, hp, weight, acceleration, year, origin, nam_of_new_column, sqrt_of_mpg_2, log(10)_of_mpg]
Index: []</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb295-1"><a href="basics-python.html#cb295-1" aria-hidden="true" tabindex="-1"></a>d[<span class="op">-</span>(d.hp.isna())] <span class="co"># delete missing values</span></span></code></pre></div>
<pre><code>      mpg  cylinders  ...  sqrt_of_mpg_2  log(10)_of_mpg
0    18.0          8  ...       4.242641        1.255273
1    15.0          8  ...       3.872983        1.176091
2    18.0          8  ...       4.242641        1.255273
3    16.0          8  ...       4.000000        1.204120
4    17.0          8  ...       4.123106        1.230449
..    ...        ...  ...            ...             ...
387  27.0          4  ...       5.196152        1.431364
388  44.0          4  ...       6.633250        1.643453
389  32.0          4  ...       5.656854        1.505150
390  28.0          4  ...       5.291503        1.447158
391  31.0          4  ...       5.567764        1.491362

[392 rows x 11 columns]</code></pre>
<hr />
</div>
<div id="data-visualization" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Data visualization</h2>
<p><strong>Correlation matrix</strong></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb297-1"><a href="basics-python.html#cb297-1" aria-hidden="true" tabindex="-1"></a>d.corr().<span class="bu">round</span>(decimals<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>                    mpg  cylinders  ...  sqrt_of_mpg_2  log(10)_of_mpg
mpg                1.00      -0.78  ...           1.00            0.98
cylinders         -0.78       1.00  ...          -0.81           -0.83
displacement      -0.81       0.95  ...          -0.83           -0.85
hp                -0.78       0.84  ...          -0.81           -0.83
weight            -0.83       0.90  ...          -0.86           -0.88
acceleration       0.42      -0.50  ...           0.44            0.45
year               0.58      -0.35  ...           0.58            0.58
origin             0.57      -0.57  ...           0.57            0.56
nam_of_new_column  1.00      -0.78  ...           1.00            0.98
sqrt_of_mpg_2      1.00      -0.81  ...           1.00            1.00
log(10)_of_mpg     0.98      -0.83  ...           1.00            1.00

[11 rows x 11 columns]</code></pre>
<p><strong>Pair plot</strong></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb299-1"><a href="basics-python.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.pairplot(d, hue=&#39;origin&#39;); # with color</span></span></code></pre></div>
<p><strong>Bar plot</strong></p>
<div class="sourceCode" id="cb300"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb300-1"><a href="basics-python.html#cb300-1" aria-hidden="true" tabindex="-1"></a>sns.set_context(<span class="st">&#39;paper&#39;</span>)</span>
<span id="cb300-2"><a href="basics-python.html#cb300-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-3"><a href="basics-python.html#cb300-3" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&quot;tips&quot;</span>)</span>
<span id="cb300-4"><a href="basics-python.html#cb300-4" aria-hidden="true" tabindex="-1"></a>tips.head()</span></code></pre></div>
<pre><code>   total_bill   tip     sex smoker  day    time  size
0       16.99  1.01  Female     No  Sun  Dinner     2
1       10.34  1.66    Male     No  Sun  Dinner     3
2       21.01  3.50    Male     No  Sun  Dinner     3
3       23.68  3.31    Male     No  Sun  Dinner     2
4       24.59  3.61  Female     No  Sun  Dinner     4</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb302-1"><a href="basics-python.html#cb302-1" aria-hidden="true" tabindex="-1"></a>sns.barplot(x <span class="op">=</span> <span class="st">&#39;day&#39;</span>, y <span class="op">=</span> <span class="st">&#39;total_bill&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;sex&#39;</span>, data <span class="op">=</span> tips, palette <span class="op">=</span> <span class="st">&#39;Blues&#39;</span>, edgecolor <span class="op">=</span> <span class="st">&#39;w&#39;</span>)</span>
<span id="cb302-2"><a href="basics-python.html#cb302-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-146-1.png" width="100%" /></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb303-1"><a href="basics-python.html#cb303-1" aria-hidden="true" tabindex="-1"></a>tips.groupby([<span class="st">&#39;day&#39;</span>,<span class="st">&#39;sex&#39;</span>]).mean()</span></code></pre></div>
<pre><code>             total_bill       tip      size
day  sex                                   
Thur Male     18.714667  2.980333  2.433333
     Female   16.715312  2.575625  2.468750
Fri  Male     19.857000  2.693000  2.100000
     Female   14.145556  2.781111  2.111111
Sat  Male     20.802542  3.083898  2.644068
     Female   19.680357  2.801786  2.250000
Sun  Male     21.887241  3.220345  2.810345
     Female   19.872222  3.367222  2.944444</code></pre>
<p><strong>Box plot</strong></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb305-1"><a href="basics-python.html#cb305-1" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&quot;tips&quot;</span>)</span>
<span id="cb305-2"><a href="basics-python.html#cb305-2" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">&quot;whitegrid&quot;</span>)</span>
<span id="cb305-3"><a href="basics-python.html#cb305-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-4"><a href="basics-python.html#cb305-4" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>)</span>
<span id="cb305-5"><a href="basics-python.html#cb305-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-147-1.png" width="100%" /></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb306-1"><a href="basics-python.html#cb306-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, boxprops<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.6</span>))</span>
<span id="cb306-2"><a href="basics-python.html#cb306-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-148-1.png" width="100%" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb307-1"><a href="basics-python.html#cb307-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&quot;day&quot;</span>, y<span class="op">=</span><span class="st">&quot;total_bill&quot;</span>, hue<span class="op">=</span><span class="st">&quot;smoker&quot;</span>,</span>
<span id="cb307-2"><a href="basics-python.html#cb307-2" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>tips, palette<span class="op">=</span><span class="st">&quot;Set3&quot;</span>)</span>
<span id="cb307-3"><a href="basics-python.html#cb307-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-148-2.png" width="100%" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb308-1"><a href="basics-python.html#cb308-1" aria-hidden="true" tabindex="-1"></a>tips[<span class="st">&#39;weekend&#39;</span>] <span class="op">=</span> tips.day.isin([<span class="st">&#39;Sat&#39;</span>, <span class="st">&#39;Sun&#39;</span>])</span>
<span id="cb308-2"><a href="basics-python.html#cb308-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-3"><a href="basics-python.html#cb308-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;day&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, hue<span class="op">=</span><span class="st">&#39;weekend&#39;</span>, dodge<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb308-4"><a href="basics-python.html#cb308-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-149-1.png" width="100%" /></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb309-1"><a href="basics-python.html#cb309-1" aria-hidden="true" tabindex="-1"></a>sns.catplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;smoker&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, hue<span class="op">=</span><span class="st">&#39;sex&#39;</span>, col<span class="op">=</span><span class="st">&#39;time&#39;</span>, kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)<span class="op">;</span></span>
<span id="cb309-2"><a href="basics-python.html#cb309-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-150-1.png" width="100%" /></p>
<div id="other-categorical-plots" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Other categorical plots</h3>
<div class="sourceCode" id="cb310"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb310-1"><a href="basics-python.html#cb310-1" aria-hidden="true" tabindex="-1"></a>sns.stripplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>)<span class="op">;</span></span>
<span id="cb310-2"><a href="basics-python.html#cb310-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-151-1.png" width="100%" /></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb311-1"><a href="basics-python.html#cb311-1" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>)<span class="op">;</span></span>
<span id="cb311-2"><a href="basics-python.html#cb311-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-152-1.png" width="100%" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb312-1"><a href="basics-python.html#cb312-1" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, hue<span class="op">=</span><span class="st">&#39;smoker&#39;</span>)<span class="op">;</span></span>
<span id="cb312-2"><a href="basics-python.html#cb312-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-152-2.png" width="100%" /></p>
<div class="sourceCode" id="cb313"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb313-1"><a href="basics-python.html#cb313-1" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, hue<span class="op">=</span><span class="st">&#39;smoker&#39;</span>, dodge<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span>
<span id="cb313-2"><a href="basics-python.html#cb313-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-152-3.png" width="100%" /></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb314-1"><a href="basics-python.html#cb314-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, fliersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb314-2"><a href="basics-python.html#cb314-2" aria-hidden="true" tabindex="-1"></a>sns.swarmplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)<span class="op">;</span></span>
<span id="cb314-3"><a href="basics-python.html#cb314-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-153-1.png" width="100%" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb315-1"><a href="basics-python.html#cb315-1" aria-hidden="true" tabindex="-1"></a>sns.boxenplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>)<span class="op">;</span></span>
<span id="cb315-2"><a href="basics-python.html#cb315-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-154-1.png" width="100%" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb316-1"><a href="basics-python.html#cb316-1" aria-hidden="true" tabindex="-1"></a>sns.boxenplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, hue<span class="op">=</span><span class="st">&#39;smoker&#39;</span>)<span class="op">;</span></span>
<span id="cb316-2"><a href="basics-python.html#cb316-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-154-2.png" width="100%" /></p>
<div class="sourceCode" id="cb317"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb317-1"><a href="basics-python.html#cb317-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;tip&#39;</span>)<span class="op">;</span></span>
<span id="cb317-2"><a href="basics-python.html#cb317-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-155-1.png" width="100%" /></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb318-1"><a href="basics-python.html#cb318-1" aria-hidden="true" tabindex="-1"></a>sns.displot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;tip&#39;</span>, kind<span class="op">=</span><span class="st">&#39;kde&#39;</span>)<span class="op">;</span></span>
<span id="cb318-2"><a href="basics-python.html#cb318-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-155-2.png" width="100%" /></p>
<p><strong>Multiple plots</strong></p>
<div class="sourceCode" id="cb319"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb319-1"><a href="basics-python.html#cb319-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">6</span>))</span>
<span id="cb319-2"><a href="basics-python.html#cb319-2" aria-hidden="true" tabindex="-1"></a>sns.boxenplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, ax<span class="op">=</span>axes.flat[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb319-3"><a href="basics-python.html#cb319-3" aria-hidden="true" tabindex="-1"></a>sns.violinplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;sex&#39;</span>, y<span class="op">=</span><span class="st">&#39;tip&#39;</span>, ax<span class="op">=</span>axes.flat[<span class="dv">1</span>])<span class="op">;</span></span>
<span id="cb319-4"><a href="basics-python.html#cb319-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-156-1.png" width="100%" /></p>
<p><strong>Multidimensional KDE for numeric variables</strong></p>
<div class="sourceCode" id="cb320"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb320-1"><a href="basics-python.html#cb320-1" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">&#39;figure.figsize&#39;</span>] <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">8</span>)</span>
<span id="cb320-2"><a href="basics-python.html#cb320-2" aria-hidden="true" tabindex="-1"></a>sns.kdeplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;tip&#39;</span>, y<span class="op">=</span><span class="st">&#39;total_bill&#39;</span>, shade<span class="op">=</span><span class="va">True</span>, cbar<span class="op">=</span><span class="va">True</span>)<span class="op">;</span></span>
<span id="cb320-3"><a href="basics-python.html#cb320-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-157-1.png" width="100%" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb321-1"><a href="basics-python.html#cb321-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(d.mpg)<span class="op">;</span> <span class="co"># Histogram</span></span>
<span id="cb321-2"><a href="basics-python.html#cb321-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-158-1.png" width="100%" /></p>
<div class="sourceCode" id="cb322"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb322-1"><a href="basics-python.html#cb322-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(d.mpg, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span> <span class="co"># with binwidth</span></span>
<span id="cb322-2"><a href="basics-python.html#cb322-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-159-1.png" width="100%" /></p>
<div class="sourceCode" id="cb323"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb323-1"><a href="basics-python.html#cb323-1" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>d, x<span class="op">=</span><span class="st">&#39;mpg&#39;</span>, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span> </span>
<span id="cb323-2"><a href="basics-python.html#cb323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-3"><a href="basics-python.html#cb323-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>d, x<span class="op">=</span><span class="st">&#39;mpg&#39;</span>, bins<span class="op">=</span><span class="dv">20</span>, cumulative<span class="op">=</span><span class="va">True</span>)<span class="op">;</span> <span class="co"># cumulative values</span></span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-159-2.png" width="100%" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb324-1"><a href="basics-python.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co">#d.origin = pd.Categorical(d.origin.replace({1: &#39;america&#39;, 2:&#39;europe&#39; 3: &#39;japan&#39;}))</span></span>
<span id="cb324-2"><a href="basics-python.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="basics-python.html#cb324-3" aria-hidden="true" tabindex="-1"></a>sns.relplot(data<span class="op">=</span>d, x<span class="op">=</span><span class="st">&#39;hp&#39;</span>, y<span class="op">=</span><span class="st">&#39;mpg&#39;</span>, hue<span class="op">=</span><span class="st">&#39;origin&#39;</span>, palette<span class="op">=</span><span class="st">&#39;tab10&#39;</span>)</span></code></pre></div>
<pre><code>&lt;seaborn.axisgrid.FacetGrid object at 0x7fa5c7754da0&gt;</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb326-1"><a href="basics-python.html#cb326-1" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-160-1.png" width="100%" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb327-1"><a href="basics-python.html#cb327-1" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> d.corr()</span>
<span id="cb327-2"><a href="basics-python.html#cb327-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr) <span class="co"># simple</span></span>
<span id="cb327-3"><a href="basics-python.html#cb327-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-161-1.png" width="100%" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb328-1"><a href="basics-python.html#cb328-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr, cmap<span class="op">=</span>plt.cm.RdYlGn, annot<span class="op">=</span><span class="va">True</span>, linewidths<span class="op">=</span><span class="dv">1</span>, square<span class="op">=</span><span class="va">True</span>, vmin<span class="op">=-</span><span class="dv">1</span>, vmax<span class="op">=</span><span class="dv">1</span>) <span class="co"># designed</span></span>
<span id="cb328-2"><a href="basics-python.html#cb328-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="Business-Analytics-Summary_files/figure-html/unnamed-chunk-161-2.png" width="100%" /></p>
<hr />
</div>
</div>
<div id="preparing-data-for-modeling" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Preparing data for modeling</h2>
<div class="sourceCode" id="cb329"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb329-1"><a href="basics-python.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb330-1"><a href="basics-python.html#cb330-1" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;mpg&#39;</span> <span class="co"># Creates the input points and the output columns</span></span>
<span id="cb330-2"><a href="basics-python.html#cb330-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [column <span class="cf">for</span> column <span class="kw">in</span> d.columns <span class="cf">if</span> column <span class="op">!=</span> label]</span></code></pre></div>
<p><strong>Setting the train / test split</strong></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb331-1"><a href="basics-python.html#cb331-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> d[features]</span>
<span id="cb331-2"><a href="basics-python.html#cb331-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> d[label]</span>
<span id="cb331-3"><a href="basics-python.html#cb331-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-4"><a href="basics-python.html#cb331-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb331-5"><a href="basics-python.html#cb331-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-6"><a href="basics-python.html#cb331-6" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(X) <span class="co"># Size of the dataset</span></span></code></pre></div>
<pre><code>392</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb333-1"><a href="basics-python.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(X_train) <span class="co"># Size of the training set</span></span></code></pre></div>
<pre><code>294</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb335-1"><a href="basics-python.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(X_test) <span class="co"># Size of the test set (In this case 25% of the dataset)</span></span></code></pre></div>
<pre><code>98</code></pre>
<p>There is also a way to avoid the randomness of the test selection:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb337-1"><a href="basics-python.html#cb337-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">0</span>) <span class="co"># We fix the random state to a certain value to make it reproducable. </span></span></code></pre></div>
<div id="creating-the-models" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Creating the models</h3>
<ul>
<li><p>Linear regression (no hyper parameters)</p></li>
<li><p>Quadratic regression (no hyper parameters)</p></li>
<li><p>Quadratic regression with LASSO (1 hyper parameter)</p></li>
</ul>
<div class="sourceCode" id="cb338"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb338-1"><a href="basics-python.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, Lasso</span></code></pre></div>
<div class="sourceCode" id="cb339"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb339-1"><a href="basics-python.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, PolynomialFeatures <span class="co"># automatically takes into account standardization</span></span>
<span id="cb339-2"><a href="basics-python.html#cb339-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-3"><a href="basics-python.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, ShuffleSplit</span>
<span id="cb339-4"><a href="basics-python.html#cb339-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-5"><a href="basics-python.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb339-6"><a href="basics-python.html#cb339-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-7"><a href="basics-python.html#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span></code></pre></div>
<p><strong>Pipeline</strong></p>
<p>A pipeline is a sequence of steps applied to the data. f.e. the first
step is scaling the data and second is training the model on the
training data.</p>
<p>Due to the package sklearn (StandardScaler), the training data is first
standardized and then this is used for the training data and test data.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb340-1"><a href="basics-python.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear regression</span></span>
<span id="cb340-2"><a href="basics-python.html#cb340-2" aria-hidden="true" tabindex="-1"></a>linreg <span class="op">=</span> make_pipeline(StandardScaler(), LinearRegression() </span>
<span id="cb340-3"><a href="basics-python.html#cb340-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb340-4"><a href="basics-python.html#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="basics-python.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic regression</span></span>
<span id="cb340-6"><a href="basics-python.html#cb340-6" aria-hidden="true" tabindex="-1"></a>quadreg <span class="op">=</span> make_pipeline(StandardScaler(), PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>), </span>
<span id="cb340-7"><a href="basics-python.html#cb340-7" aria-hidden="true" tabindex="-1"></a>LinearRegression() </span>
<span id="cb340-8"><a href="basics-python.html#cb340-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb340-9"><a href="basics-python.html#cb340-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-10"><a href="basics-python.html#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Quadratic regression with LASSO</span></span>
<span id="cb340-11"><a href="basics-python.html#cb340-11" aria-hidden="true" tabindex="-1"></a>quadlasso_empty <span class="op">=</span> make_pipeline(StandardScaler(), PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>), </span>
<span id="cb340-12"><a href="basics-python.html#cb340-12" aria-hidden="true" tabindex="-1"></a>Lasso(max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb340-13"><a href="basics-python.html#cb340-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Training (+HP tuning)</strong></p>
<div class="sourceCode" id="cb341"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb341-1"><a href="basics-python.html#cb341-1" aria-hidden="true" tabindex="-1"></a>linreg.fit(X_train, y_train) <span class="co"># fitting linear regression</span></span></code></pre></div>
<pre><code>Pipeline(steps=[(&#39;standardscaler&#39;, StandardScaler()),
                (&#39;linearregression&#39;, LinearRegression())])</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb343-1"><a href="basics-python.html#cb343-1" aria-hidden="true" tabindex="-1"></a>quadreg.fit(X_train, y_train) <span class="co"># fitting the quadratic regression</span></span></code></pre></div>
<pre><code>Pipeline(steps=[(&#39;standardscaler&#39;, StandardScaler()),
                (&#39;polynomialfeatures&#39;, PolynomialFeatures()),
                (&#39;linearregression&#39;, LinearRegression())])</code></pre>
<p>Logarithmic scale: Standard scale but raise to the power of e.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb345-1"><a href="basics-python.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the grid, and deciding which hyper parameters to try</span></span>
<span id="cb345-2"><a href="basics-python.html#cb345-2" aria-hidden="true" tabindex="-1"></a>np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>) <span class="co"># Linearly spaced</span></span></code></pre></div>
<pre><code>array([-3., -2., -1.,  0.])</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb347-1"><a href="basics-python.html#cb347-1" aria-hidden="true" tabindex="-1"></a>np.logspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>) <span class="co"># Logarithm scale</span></span></code></pre></div>
<pre><code>array([0.001, 0.01 , 0.1  , 1.   ])</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb349-1"><a href="basics-python.html#cb349-1" aria-hidden="true" tabindex="-1"></a>quadlasso_empty.get_params() <span class="co"># tells us all the parameters that we have</span></span></code></pre></div>
<pre><code>{&#39;memory&#39;: None, &#39;steps&#39;: [(&#39;standardscaler&#39;, StandardScaler()), (&#39;polynomialfeatures&#39;, PolynomialFeatures()), (&#39;lasso&#39;, Lasso(max_iter=10000))], &#39;verbose&#39;: False, &#39;standardscaler&#39;: StandardScaler(), &#39;polynomialfeatures&#39;: PolynomialFeatures(), &#39;lasso&#39;: Lasso(max_iter=10000), &#39;standardscaler__copy&#39;: True, &#39;standardscaler__with_mean&#39;: True, &#39;standardscaler__with_std&#39;: True, &#39;polynomialfeatures__degree&#39;: 2, &#39;polynomialfeatures__include_bias&#39;: True, &#39;polynomialfeatures__interaction_only&#39;: False, &#39;polynomialfeatures__order&#39;: &#39;C&#39;, &#39;lasso__alpha&#39;: 1.0, &#39;lasso__copy_X&#39;: True, &#39;lasso__fit_intercept&#39;: True, &#39;lasso__max_iter&#39;: 10000, &#39;lasso__normalize&#39;: False, &#39;lasso__positive&#39;: False, &#39;lasso__precompute&#39;: False, &#39;lasso__random_state&#39;: None, &#39;lasso__selection&#39;: &#39;cyclic&#39;, &#39;lasso__tol&#39;: 0.0001, &#39;lasso__warm_start&#39;: False}</code></pre>
<p>We want to use lasso__alpha as the name.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb351-1"><a href="basics-python.html#cb351-1" aria-hidden="true" tabindex="-1"></a>grid <span class="op">=</span> {<span class="st">&#39;lasso__alpha&#39;</span>: np.logspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">20</span>)}</span>
<span id="cb351-2"><a href="basics-python.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Log space tells it how many parameters to try. The first number: lowest value, second number: highest value, third number how many we want to generate</span></span>
<span id="cb351-3"><a href="basics-python.html#cb351-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-4"><a href="basics-python.html#cb351-4" aria-hidden="true" tabindex="-1"></a>holdout <span class="op">=</span> ShuffleSplit(test_size<span class="op">=</span><span class="fl">.25</span>, n_splits<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">0</span>) <span class="co"># validation method holdout</span></span></code></pre></div>
<p>Grid search object:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb352-1"><a href="basics-python.html#cb352-1" aria-hidden="true" tabindex="-1"></a>quadlasso <span class="op">=</span> GridSearchCV(estimator <span class="op">=</span>   quadlasso_empty, </span>
<span id="cb352-2"><a href="basics-python.html#cb352-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> grid, </span>
<span id="cb352-3"><a href="basics-python.html#cb352-3" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> holdout, </span>
<span id="cb352-4"><a href="basics-python.html#cb352-4" aria-hidden="true" tabindex="-1"></a>scoring <span class="op">=</span> <span class="st">&#39;neg_mean_squared_error&#39;</span> <span class="co"># negative to understand which is the best value</span></span>
<span id="cb352-5"><a href="basics-python.html#cb352-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb352-6"><a href="basics-python.html#cb352-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-7"><a href="basics-python.html#cb352-7" aria-hidden="true" tabindex="-1"></a>quadlasso.fit(X_train, y_train) <span class="co"># automatically refits</span></span></code></pre></div>
<pre><code>GridSearchCV(cv=ShuffleSplit(n_splits=1, random_state=0, test_size=0.25, train_size=None),
             estimator=Pipeline(steps=[(&#39;standardscaler&#39;, StandardScaler()),
                                       (&#39;polynomialfeatures&#39;,
                                        PolynomialFeatures()),
                                       (&#39;lasso&#39;, Lasso(max_iter=10000))]),
             param_grid={&#39;lasso__alpha&#39;: array([0.001     , 0.00143845, 0.00206914, 0.00297635, 0.00428133,
       0.00615848, 0.00885867, 0.01274275, 0.01832981, 0.02636651,
       0.0379269 , 0.05455595, 0.078476  , 0.11288379, 0.16237767,
       0.23357215, 0.33598183, 0.48329302, 0.6951928 , 1.        ])},
             scoring=&#39;neg_mean_squared_error&#39;)</code></pre>
<hr />
</div>
</div>
<div id="model-selection" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Model selection</h2>
<p><strong>Mean Squared Error Method</strong></p>
<div class="sourceCode" id="cb354"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb354-1"><a href="basics-python.html#cb354-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, linreg.predict(X_test))</span></code></pre></div>
<pre><code>8.857781021481647e-29</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb356-1"><a href="basics-python.html#cb356-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, quadreg.predict(X_test))</span></code></pre></div>
<pre><code>8.126877243991158e-29</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb358-1"><a href="basics-python.html#cb358-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(y_test, quadlasso.predict(X_test))</span></code></pre></div>
<pre><code>3.5002060278057675e-06</code></pre>
<p>‘We choose the model with the lowest error. In this example, it is the
last model.’</p>
<blockquote>
<p><strong>IMPORTANT</strong> It is important to note that before using the model in
production, I must retrain it on the entire data set.</p>
</blockquote>
<p>We use the model on the entire data set:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb360-1"><a href="basics-python.html#cb360-1" aria-hidden="true" tabindex="-1"></a>winner <span class="op">=</span> quadlasso.best_estimator_ <span class="co"># selects the best hyper parameter</span></span>
<span id="cb360-2"><a href="basics-python.html#cb360-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-3"><a href="basics-python.html#cb360-3" aria-hidden="true" tabindex="-1"></a>winner.fit(X, y)</span></code></pre></div>
<pre><code>Pipeline(steps=[(&#39;standardscaler&#39;, StandardScaler()),
                (&#39;polynomialfeatures&#39;, PolynomialFeatures()),
                (&#39;lasso&#39;, Lasso(alpha=0.001, max_iter=10000))])</code></pre>
<p>As an example, below a car has been included which was not part of our
data set. We can test the model on the prediction accuracy.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb362-1"><a href="basics-python.html#cb362-1" aria-hidden="true" tabindex="-1"></a>seat_marbella <span class="op">=</span> [<span class="dv">4</span>, <span class="dv">899</span> <span class="op">*</span> <span class="fl">0.061</span>, <span class="dv">41</span>, <span class="dv">680</span> <span class="op">*</span> <span class="fl">2.2</span>, <span class="fl">19.2</span>, <span class="dv">83</span>, <span class="dv">2</span>] <span class="co"># features loaded to compare</span></span>
<span id="cb362-2"><a href="basics-python.html#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="basics-python.html#cb362-3" aria-hidden="true" tabindex="-1"></a>y_marbella <span class="op">=</span> (<span class="dv">100</span> <span class="op">*</span> <span class="fl">3.78</span>) <span class="op">/</span> (<span class="fl">1.61</span> <span class="op">*</span> <span class="fl">5.1</span>) <span class="co"># labels loaded</span></span></code></pre></div>
<p>Now we ask the model to predict the full efficiency of the car:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb363-1"><a href="basics-python.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co">#prediction = winner.predict([seat_marbella])</span></span>
<span id="cb363-2"><a href="basics-python.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co">#prediction[0]</span></span></code></pre></div>
<p>The real value is:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r watch-out"><code class="sourceCode r"><span id="cb364-1"><a href="basics-python.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co">#y_marbella</span></span></code></pre></div>
<p>We can compare the accuracy of the prediction and the real value.</p>
<div id="leave-one-out-cross-validation-loocv" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> <strong>Leave-One-Out Cross validation (LOOCV):</strong></h3>
<div class="sourceCode" id="cb365"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb365-1"><a href="basics-python.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> LeaveOneOut, cross_val_score</span>
<span id="cb365-2"><a href="basics-python.html#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="basics-python.html#cb365-3" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pd.read_csv(<span class="st">&#39;www/auto-mpg.csv&#39;</span>)</span>
<span id="cb365-4"><a href="basics-python.html#cb365-4" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="st">&#39;mpg&#39;</span></span>
<span id="cb365-5"><a href="basics-python.html#cb365-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [col <span class="cf">for</span> col <span class="kw">in</span> d.columns <span class="cf">if</span> col <span class="op">!=</span> label]</span>
<span id="cb365-6"><a href="basics-python.html#cb365-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> d[features]</span>
<span id="cb365-7"><a href="basics-python.html#cb365-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> d[label]</span></code></pre></div>
<div class="sourceCode" id="cb366"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb366-1"><a href="basics-python.html#cb366-1" aria-hidden="true" tabindex="-1"></a>linreg <span class="op">=</span> make_pipeline(StandardScaler(), LinearRegression() </span>
<span id="cb366-2"><a href="basics-python.html#cb366-2" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb366-3"><a href="basics-python.html#cb366-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-4"><a href="basics-python.html#cb366-4" aria-hidden="true" tabindex="-1"></a>quadreg <span class="op">=</span> make_pipeline(StandardScaler(), PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>), </span>
<span id="cb366-5"><a href="basics-python.html#cb366-5" aria-hidden="true" tabindex="-1"></a>LinearRegression() </span>
<span id="cb366-6"><a href="basics-python.html#cb366-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb366-7"><a href="basics-python.html#cb366-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-8"><a href="basics-python.html#cb366-8" aria-hidden="true" tabindex="-1"></a>quadlasso_empty <span class="op">=</span> make_pipeline(StandardScaler(), PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>), </span>
<span id="cb366-9"><a href="basics-python.html#cb366-9" aria-hidden="true" tabindex="-1"></a>Lasso(max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb366-10"><a href="basics-python.html#cb366-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Creating a function: a set of instructions that we combine to provide
some inputs to retrieve some outputs. This functions computers the
<span class="math inline">\(\hat {ERR}_{\hat f}\)</span> and will take as its input the model <span class="math inline">\(\hat f\)</span>:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb367-1"><a href="basics-python.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_mse(model):</span>
<span id="cb367-2"><a href="basics-python.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  mses <span class="op">=</span> cross_val_score(estimator<span class="op">=</span>model,</span>
<span id="cb367-3"><a href="basics-python.html#cb367-3" aria-hidden="true" tabindex="-1"></a>  X<span class="op">=</span>X, </span>
<span id="cb367-4"><a href="basics-python.html#cb367-4" aria-hidden="true" tabindex="-1"></a>  y<span class="op">=</span>y, </span>
<span id="cb367-5"><a href="basics-python.html#cb367-5" aria-hidden="true" tabindex="-1"></a>  cv<span class="op">=</span>LeaveOneOut(),</span>
<span id="cb367-6"><a href="basics-python.html#cb367-6" aria-hidden="true" tabindex="-1"></a>  scoring<span class="op">=</span><span class="st">&#39;neg_mean_squared_error&#39;</span></span>
<span id="cb367-7"><a href="basics-python.html#cb367-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb367-8"><a href="basics-python.html#cb367-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> np.average(<span class="op">-</span>mses) <span class="co"># takes the average of the mean square errors</span></span></code></pre></div>
<p>Calculating the mean squared error through the leave one out method:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb368-1"><a href="basics-python.html#cb368-1" aria-hidden="true" tabindex="-1"></a>get_mse(linreg)</span></code></pre></div>
<pre><code>11.371126332686618</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb370-1"><a href="basics-python.html#cb370-1" aria-hidden="true" tabindex="-1"></a>get_mse(quadreg)</span></code></pre></div>
<pre><code>7.97288701609446</code></pre>
</div>
<div id="k-fold-cross-validation" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> <strong>K-Fold Cross validation</strong></h3>
<p>K = 5 folds. The model used is the same as above.</p>
</div>
<div id="svc" class="section level3" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> SVC</h3>
<p>Make list to create the model</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb372-1"><a href="basics-python.html#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># svc = make_pipeline( transformer, GridSearchCV( estimator=SVC(kernel=&quot;linear&quot;), param_grid={ &quot;C&quot;: np.logspace(-3, 3, 50) }, cv=kfold, n_jobs=4 ) )</span></span></code></pre></div>
<p>The default of scoring = the estimator’s score method, the accuracy</p>
<p>Fit model</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb373-1"><a href="basics-python.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co">#svc.fit(X_tv, y_tv)</span></span></code></pre></div>
<p>Gives us the best estimator:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb374-1"><a href="basics-python.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co">#svc[1].best_estimator_</span></span></code></pre></div>
<p>If it is at the edge of the grid, make another grid closer to the
extremes.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb375-1"><a href="basics-python.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pred = svc.predict(X_test)</span></span></code></pre></div>
<div class="sourceCode" id="cb376"><pre class="sourceCode python watch-out"><code class="sourceCode python"><span id="cb376-1"><a href="basics-python.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb376-2"><a href="basics-python.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb376-3"><a href="basics-python.html#cb376-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-4"><a href="basics-python.html#cb376-4" aria-hidden="true" tabindex="-1"></a><span class="co">#accuracy_score(y_test, pred)</span></span>
<span id="cb376-5"><a href="basics-python.html#cb376-5" aria-hidden="true" tabindex="-1"></a><span class="co">#recall_score(y_test, pred)</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="structural-equation-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="practical-data-science.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Business-Analytics-Summary.pdf", "Business-Analytics-Summary.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
